<!DOCTYPE html>
<html>

<head>
    <script src="main.js"></script>
    <style>
        body {
            background-color: var(--uxp-host-background-color, #323232);
            color: var(--uxp-host-text-color, #ffffff);
            font-family: system-ui, sans-serif;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* Main Container */
        .main-container {
            width: 320px;
            /* Fixed width as requested */
            margin: 0 auto;
            padding: 12px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            gap: 12px;
            height: 100%;
            overflow-y: auto;
        }

        /* Header / Tabs */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        /* Tabs - Kitchen Sink Style */
        .sp-tabs {
            flex: 0 0 auto;
            display: flex;
            flex-direction: row;
            border-bottom: 2px solid #3E3E3E;
            width: 100%;
            margin-bottom: 12px;
        }

        .sp-tab {
            margin-right: 12px;
            cursor: pointer;
            padding-bottom: 6px;
        }

        .sp-tab sp-label {
            color: rgba(255, 255, 255, 0.75);
            cursor: pointer;
        }

        .sp-tab:hover sp-label {
            color: white;
        }

        .sp-tab.selected {
            border-bottom: 2px solid white;
            margin-bottom: -2px;
        }

        .sp-tab.selected sp-label {
            color: white;
        }

        /* Sections */
        .section {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .row {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .row-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .row-end {
            display: flex;
            justify-content: flex-end;
            gap: 6px;
        }

        /* Components overrides/helpers */
        sp-dropdown {
            width: 100%;
        }

        sp-textfield,
        sp-textarea {
            width: 100%;
        }




        /* Utility classes */
        .hidden {
            display: none !important;
        }

        .full-width {
            width: 100%;
        }

        sp-divider {
            margin: 4px 0;
        }

        .status-message {
            font-size: 11px;
            margin-top: 4px;
            min-height: 20px;
        }

        .status-success {
            color: #2dcc70;
        }

        .status-error {
            color: #ff5555;
        }

        .status-info {
            color: #aaaaaa;
        }

        /* Scrollbar styling for WebKit (UXP uses WebKit) */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #505050;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #606060;
        }
    </style>
</head>

<body>
    <div class="main-container">
        <!-- Header & Tabs -->
        <!-- <div class="header">
            <sp-heading size="S" style="margin: 0; text-align: right; font-size: 13px;">PS Banana by LiuYang</sp-heading>
        </div> -->

        <div class="sp-tabs">
            <div class="sp-tab selected" id="tabGenerate"><sp-label>Generate</sp-label></div>
            <div class="sp-tab" id="tabSettings"><sp-label>Settings</sp-label></div>
        </div>

        <!-- Generate Tab Content -->
        <div id="contentGenerate" class="section">

            <!-- Prompt Presets -->
            <div class="section">
                <sp-label>Prompt Presets</sp-label>
                <sp-dropdown size="s" id="presetSelect" placeholder="Select a preset...">
                    <sp-menu slot="options"></sp-menu>
                </sp-dropdown>
                <div class="row-end">
                    <!-- Changed to text buttons for better visibility -->
                    <sp-action-button id="btnAddPreset" size="s">Add</sp-action-button>
                    <sp-action-button id="btnSavePreset" size="s">Save</sp-action-button>
                    <sp-action-button id="btnRenamePreset" size="s">Rename</sp-action-button>
                    <sp-action-button id="btnDeletePreset" size="s">Del</sp-action-button>
                </div>
            </div>

            <!-- Prompt Input -->
            <div class="section">
                <sp-label>Prompt</sp-label>
                <sp-textarea size="s" id="promptInput" placeholder="Enter your image generation prompt..."></sp-textarea>
            </div>
            <sp-divider size="small"></sp-divider>

            <!-- Resolution & Smart Ratio -->
            <div class="row" style="align-items: flex-end;">
                <div style="flex: 0 0 auto; margin:0 5px 0 0;">
                    <sp-label size="s">Resolution:</sp-label>
                </div>
                <div style="flex: 1;">
                    <sp-dropdown size="s" id="resolutionSelect" placeholder="Select" style="width: 100%;">
                        <sp-menu slot="options">
                            <sp-menu-item value="1K" selected>1K</sp-menu-item>
                            <sp-menu-item value="2K">2K</sp-menu-item>
                            <sp-menu-item value="4K">4K</sp-menu-item>
                        </sp-menu>
                    </sp-dropdown>
                </div>
                <div style="flex: 1.8; margin: 0 0 0 10px;">
                    <sp-action-button size="s" id="btnSmartCanvasRatio" style="width: 100%;"> Smart Ratio </sp-action-button>
                </div>
            </div>

            <!-- Toggles -->
            <div class="section">
                <sp-checkbox size="s" id="searchWebCheckbox">Search Web (Experimental)</sp-checkbox>
                <sp-checkbox size="s" id="selectionModeCheckbox">Generate Only Selection Area</sp-checkbox>
            </div>

            <!-- Generate Button -->
            <sp-action-button id="btnGenerate" class="full-width" size="l">Generate Image</sp-action-button>

            <!-- Generation Mode Radio Group -->
            <div class="section" id="generationModeRadio">
                <!-- <sp-label>Generation Mode</sp-label> -->
                <sp-radio-group id="generationModeGroup">
                    <sp-radio value="text2img" checked>Text to Image</sp-radio>
                    <sp-radio value="imgedit">Image Edit</sp-radio>
                </sp-radio-group>
            </div>

            <!-- Multi-Image Mode (Hidden by default) -->
            <div id="multiImageModeSection" class="section hidden">
                <sp-checkbox size="s" id="multiImageModeCheckbox">Use Multi-Image Mode</sp-checkbox>
                <sp-action-button size="m" id="btnEnsureGroups" class="full-width">New Reference/Source
                    Group</sp-action-button>
            </div>

            <!-- Status -->
            <div id="generateStatus" class="status-message"></div>
        </div>

        <!-- Settings Tab Content (Hidden by default) -->
        <div id="contentSettings" class="section hidden">

            <!-- Provider Settings -->
            <div class="section">
                <sp-label>Provider</sp-label>
                <sp-dropdown size="s" id="providerSelect" placeholder="Select Provider">
                    <sp-menu slot="options"></sp-menu>
                </sp-dropdown>
                <div class="row-end">
                    <sp-action-button id="btnAddProvider" size="s">Add</sp-action-button>
                    <sp-action-button id="btnSaveProvider" size="s">Save</sp-action-button>
                    <sp-action-button id="btnDeleteProvider" size="s">Del</sp-action-button>
                    <sp-action-button id="btnTestConnection" size="s">Test Connection</sp-action-button>
                </div>
            </div>

            <div id="connectionStatus" class="status-message"></div>

            <!-- <sp-divider size="small"></sp-divider> -->

            <!-- API Config -->
            <div class="section">
                <sp-textfield size="s" id="inputApiKey" type="password" placeholder="Enter API Key">
                    <sp-label slot="label">API Key</sp-label>
                </sp-textfield>
                <sp-textfield size="s" id="inputBaseUrl" placeholder="https://...">
                    <sp-label slot="label">Base URL</sp-label>
                </sp-textfield>
                <sp-textfield size="s" id="inputModelId" placeholder="model-name">
                    <sp-label slot="label">Model ID</sp-label>
                </sp-textfield>
            </div>

            <sp-divider size="small"></sp-divider>

            <!-- Export Settings -->
            <div class="section">
                <sp-label>Image to Generator Export Settings</sp-label>
                <div class="row">
                    <sp-textfield size="s" id="inputMaxSize" type="number" placeholder="2048" min="512" max="8192" step="256"
                        style="flex:1;">
                        <sp-label slot="label">Max Size</sp-label>
                    </sp-textfield>
                    <sp-textfield size="s" id="inputQuality" type="number" placeholder="80" min="0" max="100" step="1"
                        style="flex:1;">
                        <sp-label slot="label">Quality</sp-label>
                    </sp-textfield>
                </div>
            </div>

            <sp-divider size="small"></sp-divider>

            <!-- Debug Settings -->
            <div class="section">
                <sp-checkbox size="s" id="debugModeCheckbox">Debug Mode</sp-checkbox>
                <div id="debugDetailsSection" class="section hidden">
                    <sp-textfield  size="s" id="debugFolderPath" readonly placeholder="Log path will appear here" quiet>
                        <sp-label slot="label">Log File Path</sp-label>
                    </sp-textfield>
                    <!-- Debug Buttons -->
                    <div class="row" style="gap: 8px;">
                        <sp-action-button size="s" id="btnTestExport" style="flex: 1;">Test Export</sp-action-button>
                        <sp-action-button size="s" id="btnTestImport" style="flex: 1;">Test Import</sp-action-button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row-end" style="margin-top: auto; padding-top: 10px;">
            <sp-body size="XS" style="color: #666;">PSBanana by LiuYang v1.5.0</sp-body>
        </div>
    </div>
</body>

</html>